## 题目 01- 请你说一说什么是线程和进程？

线程是程序执行的最小单位，是进程中的一个执行流。一个进程可以包含多个线程，这些线程共享进程的资源（如内存），但每个线程都有自己的执行路径和栈空间。线程之间可以并发执行，共享进程的上下文，可以更高效地利用多核处理器。线程之间的通信相对容易，但需要注意线程同步和互斥的问题。

进程是操作系统中的一个执行实体，它具有独立的内存空间和系统资源。每个进程都是独立运行的，它们之间相互隔离，不共享内存和资源。进程是操作系统进行资源分配和调度的基本单位。进程之间的通信相对复杂，需要使用进程间通信（IPC）机制，如管道、信号量、共享内存等。

区别和联系：

- 进程之间相互独立，线程共享进程的资源。
- 进程之间的切换开销较大，线程之间的切换开销较小。
- 一个进程可以包含多个线程，这些线程共享进程的资源。
- 多线程可以提高程序的并发性和响应性，充分利用多核处理器的优势。

线程的上下文切换是指在多线程环境下，由于线程切换或调度而导致当前线程的执行状态（包括程序计数器、寄存器状态、栈指针等）被保存，同时加载另一个线程的执行状态。线程的上下文切换会涉及保存和恢复寄存器状态、切换栈指针等操作，开销较小，但仍然存在一定的开销。

线程的并发与并行的区别：

- 并发指的是多个任务交替执行的情况，这些任务在时间上有重叠，但不一定同时执行。并发可以通过时间片轮转等方式实现，提高系统的吞吐量，但并不一定能够加速单个任务的执行。
- 并行指的是多个任务同时执行的情况，这些任务在同一时刻同时执行。并行可以通过多核处理器或分布式系统等方式实现，能够加速多个任务的执行。

## 题目 02- 使用了多线程会带来什么问题呢？

1. 线程安全问题：  
   多线程环境下，多个线程同时访问和修改共享的数据或资源可能导致以下问题：
   
   - 竞态条件：多个线程对同一数据进行读写操作，结果依赖于执行的顺序，导致无法确定的结果。
   - 数据一致性问题：多个线程对共享数据进行修改，导致数据的状态不一致。
   - 死锁：多个线程因为互相等待对方释放资源而无法继续执行。

2. 原子性是指一个操作是不可中断的，要么全部执行完成，要么完全不执行。在多线程环境下，原子性操作可以避免竞态条件和数据不一致的问题。常见的原子操作包括加锁、使用原子类、使用同步工具等。

3. 有序性指的是程序执行的结果与预期的顺序一致。在多线程环境下，由于指令重排和多级缓存等优化机制的存在，线程之间的执行顺序可能与代码的编写顺序不一致。为了保证有序性，可以使用同步机制（如锁、volatile关键字、原子类等）或者使用 happens-before 原则来确保特定的顺序关系。

4. 可见性指的是当一个线程对共享变量进行修改后，其他线程能够立即看到这个修改。在多线程环境下，由于线程之间的缓存不一致或指令重排等原因，一个线程对共享变量的修改可能对其他线程不可见，导致数据不一致的问题。为了保证可见性，可以使用同步机制（如锁、volatile关键字、原子类等）或者使用 happens-before 原则来确保对共享变量的读写操作的顺序性和可见性。

## 题目 03- 什么是死锁？如何排查死锁?

死锁是指在多线程或多进程环境中，每个线程或进程持有一些资源，同时又等待其他线程或进程释放它们所需要的资源，导致所有线程或进程都无法继续执行的情况。

死锁通常涉及以下几个必要条件：

1. 互斥条件：资源只能被一个线程或进程占用，其他线程或进程必须等待。
2. 请求与保持条件：一个线程或进程在持有一些资源的同时，又请求其他资源。
3. 不可剥夺条件：已经分配给一个线程或进程的资源不能被强制性地剥夺。
4. 循环等待条件：多个线程或进程形成一个循环等待资源的链。

排查死锁的过程可以包括以下步骤：

1. 确认是否发生死锁：
   
   - 检查程序是否出现了无法继续执行的情况。
   - 观察系统的资源使用情况，是否存在资源被持有而无法释放的情况。

2. 定位死锁点：
   
   - 分析程序的逻辑和资源分配情况，确定可能发生死锁的地方。
   - 使用工具或日志记录来追踪线程或进程的状态，确定是否存在相互等待资源的情况。

3. 收集死锁信息：
   
   - 获取死锁发生时的线程或进程堆栈信息，包括持有的锁、等待的锁等。
   - 获取系统的资源使用情况，包括已分配的资源和等待的资源。

4. 分析死锁原因：
   
   - 分析死锁发生的原因，是否满足死锁的必要条件。
   - 检查是否存在资源分配顺序的问题，是否存在循环等待的情况。

5. 解决死锁问题：
   
   - 重新设计程序逻辑，避免死锁的发生。
   - 使用合适的同步机制和调度策略来避免死锁。
   - 引入超时机制，当等待时间超过一定阈值时，主动释放已持有的资源并进行重试。


